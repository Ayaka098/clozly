(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{5760:function(e,t,n){Promise.resolve().then(n.bind(n,2729))},2729:function(e,t,n){"use strict";n.d(t,{default:function(){return c}});var r=n(7437),s=n(2265),l=n(998);let a={save:async e=>new Promise((t,n)=>{let r=indexedDB.open("clozly",1);r.onupgradeneeded=()=>{let e=r.result;e.objectStoreNames.contains("images")||e.createObjectStore("images")},r.onerror=()=>n(r.error),r.onsuccess=()=>{let s=r.result.transaction("images","readwrite");s.objectStore("images").put(e,"fullbody"),s.oncomplete=()=>t(),s.onerror=()=>n(s.error)}}),load:async()=>new Promise((e,t)=>{let n=indexedDB.open("clozly",1);n.onupgradeneeded=()=>{let e=n.result;e.objectStoreNames.contains("images")||e.createObjectStore("images")},n.onerror=()=>t(n.error),n.onsuccess=()=>{let r=n.result.transaction("images","readonly").objectStore("images").get("fullbody");r.onsuccess=()=>{var t;return e(null!==(t=r.result)&&void 0!==t?t:null)},r.onerror=()=>t(r.error)}}),clear:async()=>new Promise((e,t)=>{let n=indexedDB.open("clozly",1);n.onupgradeneeded=()=>{let e=n.result;e.objectStoreNames.contains("images")||e.createObjectStore("images")},n.onerror=()=>t(n.error),n.onsuccess=()=>{let r=n.result.transaction("images","readwrite");r.objectStore("images").delete("fullbody"),r.oncomplete=()=>e(),r.onerror=()=>t(r.error)}})};var o=n(9439);function c(){let{data:e}=(0,l.useSession)(),[t,n]=(0,s.useState)(null),[c,i]=(0,s.useState)("白のきれいめトップス"),[u,d]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=(0,o.h)();(null==e?void 0:e.usualSize)&&d(e.usualSize),a.load().then(e=>{e&&n(URL.createObjectURL(e))})},[]);let m=(0,s.useMemo)(()=>{let e=u?"サイズ感は".concat(u,"。"):"";return"全身写真の人物が、以下の服を試着しているイメージを生成してください。\n"+"服の説明: ".concat(c,"\n")+"".concat(e,"\n")+"背景はシンプルに。"},[c,u]),g=async e=>{e&&(await a.save(e),n(URL.createObjectURL(e)))},b=async()=>{await a.clear(),n(null)};return(0,r.jsxs)("section",{className:"fade-in",style:{display:"grid",gap:18},children:[(0,r.jsxs)("div",{className:"card",style:{display:"grid",gap:14},children:[(0,r.jsx)("div",{className:"label",children:"ログイン"}),(null==e?void 0:e.user)?(0,r.jsx)("button",{className:"btn btn-secondary",onClick:()=>(0,l.signOut)(),children:"ログアウト"}):(0,r.jsx)("button",{className:"btn",onClick:()=>(0,l.signIn)("google"),children:"Googleでログイン"})]}),(0,r.jsxs)("div",{className:"card",style:{display:"grid",gap:14},children:[(0,r.jsx)("div",{className:"label",children:"全身画像"}),(0,r.jsx)("input",{className:"input",type:"file",accept:"image/*",onChange:e=>{var t,n;return g(null!==(n=null===(t=e.target.files)||void 0===t?void 0:t[0])&&void 0!==n?n:null)}}),t&&(0,r.jsx)("img",{src:t,alt:"全身画像",style:{width:"100%",borderRadius:16,border:"1px solid var(--line)"}}),(0,r.jsx)("button",{className:"btn btn-secondary",onClick:b,children:"画像を削除"})]}),(0,r.jsxs)("div",{className:"card",style:{display:"grid",gap:12},children:[(0,r.jsx)("div",{className:"label",children:"プロンプト"}),(0,r.jsx)("input",{className:"input",value:c,onChange:e=>i(e.target.value)}),(0,r.jsx)("textarea",{className:"input",rows:6,value:m,readOnly:!0}),(0,r.jsx)("button",{className:"btn",onClick:()=>navigator.clipboard.writeText(m),children:"プロンプトをコピー"}),t&&(0,r.jsx)("a",{className:"btn btn-secondary",href:t,download:"clozly-fullbody",children:"画像をダウンロード"})]})]})}},9439:function(e,t,n){"use strict";n.d(t,{I:function(){return l},h:function(){return s}});let r="clozly-profile";function s(){let e=window.localStorage.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function l(e){window.localStorage.setItem(r,JSON.stringify(e))}}},function(e){e.O(0,[998,971,23,744],function(){return e(e.s=5760)}),_N_E=e.O()}]);